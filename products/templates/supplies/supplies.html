{% extends "base/base_nav_footer.html" %} 
{% load static  %}
{% block link %}
<link rel="stylesheet" type='text/css' href="{% static 'css/products/supplies.css' %}"> 
{% endblock link %}
{% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="col-md-4 col-sm-12">
      <div class="list-group" id="list-tab" role="tablist">             
        {% for sp in supplies %} 
         {% ifchanged sp.category %}         
          <a href="">
            <button type="button" class="c-{{sp.category}} btn btn-dark col-12">{{sp.category}}</button>
          </a>                               
         {% endifchanged %}
          {% if sp == supplies|first %}
          <a class="{{sp.category}} list-group-item list-group-item-action active" id="list-{{sp.pk}}-list" data-toggle="list" href="#{{sp.pk}}-home" role="tab" aria-controls="{{sp.pk}}">
          {% else %}
          <a class="{{sp.category}} list-group-item list-group-item-action" id="list-{{sp.pk}}-list" data-toggle="list" href="#{{sp.pk}}-home" role="tab" aria-controls="{{sp.pk}}">
          {% endif %} 
          {{sp.name}}
          </a>                                
        {% endfor %}      
      </div>
    </div>
    <div class="col-md-8 col-sm-12">
      <div class="tab-content" id="nav-tabContent">
        {% for sp in supplies %}
        {% if sp == supplies|first %}
          <div class="tab-pane fade show active" id="{{sp.pk}}-home" role="tabpanel" aria-labelledby="list-{{sp.pk}}-list">
        {% else %}
          <div class="tab-pane fade" id="{{sp.pk}}-home" role="tabpanel" aria-labelledby="list-{{sp.pk}}-list">
        {% endif %}        
          <div class="row">
            <div class="col-md-6">
              <h1 class="text-center">{{sp.name}}</h1>
              <div class="img-c row">
                <div class="col-md-12">
                  <img src="{{sp.image.url}}">
                </div>
              </div>
              <div class="row">
                <a title="Modificar" class="col-6 material-icons text-center" href="{% url 'products:supply_modify' sp.pk %}">create</a>
                <a title="Eliminar" class="col-6 material-icons text-center" href="{% url 'products:supply_delete' sp.pk %}">delete</a>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <h1 class="text-center">Presentaciones</h1>
                  <button type="button" class="btn btn-primary col-12" data-toggle="modal" data-target="#PresentationModal">
                    Nueva Presentacion
                  </button>                  
                  <ul class="list-group">
                  {% for presentation in presentations %}
                      {% if sp == presentation.supply %}
                        <li class="list-group-item">
                            {{presentation}}
                        </li>
                      {% endif %}
                  {% endfor %}                  
                  </ul>                  
                </div>
              </div>
            </div>
            <div class="col-md-6">
                <div class="row">
                  <div class="col-12">
                      <h1 class="text-center">Detalles</h1>
                  </div>
                  <div class="col-12">
                      <div class="row">
                          <div class="col-6">
                              <dt class="text-right">Categoria:</dt>
                          </div>
                          <div class="col-6">
                              {{sp.category}}
                          </div>                                                                              
                      </div>
                  </div>
                  <div class="col-12">
                    <h1 class="text-center">Grafica</h1>
                    <!--Chart-->
                    <canvas id="myChart-{{sp.pk}}" class="{{sp.name}}" width="400" height="400"></canvas>
                  </div>
                </div>
              </div>
          </div>
        </div>
        {% endfor %}        
      </div>
    </div>
  </div>  
</div>
<div class="popout">
  <div class="FAB" id="fab-add-supply">
    <i class="material-icons">add</i>
  </div>
</div>

<!-- Presentation Modal -->
<div class="modal fade" id="PresentationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

{% endblock content %}

{% block javascript %}
<script type="text/javascript">
  $(function() {
    
    $('#fab-add-supply').click(function(event) {
      location.href = '/supplies/new/';
    });

    $('.c-Ingrediente').click(function(e){      
      e.preventDefault();
      $('.Ingrediente').fadeToggle();
    });

    $('.c-FD').click(function (e) {
      e.preventDefault();
      $('.FD').fadeToggle();
    });

    $('#new_presentation').click(function(){

      swal()


      // $.ajax({
      //     url: '{% url "products:supplies" %}',
      //     type: 'POST',
      //     data: {
      //         'type': 'shop_list',
      //         'shop_list': JSONSale,
      //         csrfmiddlewaretoken: csrf_token,
      //     },
      //     traditional: true,
      //     datatype: 'jsonp',
      //     success: function (result) {
      //         swal({
      //             title: "Ã‰xito",
      //             text: "Lista Guardada",
      //             type: "success",
      //             showConfirmButton: false,
      //         });
      //         location.replace('{% url "products:shoplist" %}');
      //     },
      //     error: function (result, jqXHR, textStatus, errorThrown) {
      //         swal({
      //             title: "Lista no Guardada!",
      //             text: 'Contacte a soporte!\n ' + 'Errores: ' + textStatus + ', ' + jqXHR,
      //             type: "error",
      //             showConfirmButton: false
      //         });
      //         setTimeout(rel, 30000);
      //     },
      // });
    }):



  });
</script>
{% endblock javascript %}